<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>General setting</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>The package <code>mistral</code> provides some numerical methods for estimating the probability that a computer code exceeds a given threshold when its input parameters are random with a known distribution. In this vignette we give an overview of the available methods as well as some practical testcases to clarify both how to use them and what they do.</p>

<h2>General setting</h2>

<p>Given an input random vector \(\mathbf{X}\) with known distribution and a real-valued function \(g\) standing for the computer code, the general problem addressed in this package is to estimate the quantity:
\[
p = P[g(\mathbf{X}) > q]
\]
with \(p\) or \(q\) a given real:</p>

<ul>
<li>either \(q\) is given and the goal is to estimate the probability \(p\); in this setting \(q\) is for instance a security threshold and one wants to estimate the probability that the code be greater than this value.</li>
<li>or \(p\) is given and the goal is to find the corresponding threshold such that the probability of failure is lower than required.</li>
</ul>

<h3>The standard input space</h3>

<p>By definition, we call the standard input space the case where \(\mathbf{X}\) is a standard Gaussian vector, ie. a vector with independent standard Gaussian coordinates. <strong>All the stochastic methods are developed for a standard Gaussian input space.</strong> In other words, when the problem at hand does not use only independent standard Gaussian random variables, an iso-probabilistic transformation has to be done before a call to the code <code>g</code>, often called the limit-state function <code>lsf</code>.</p>

<p><code>mistral</code> provides a way to perform such transformations for model using correlated inputs with usual distributions. In the following the original vector is denoted by \(\mathbf{X}\) while its conterpart in the standard space is denoted by \(\mathbf{U}\). The two functions <code>mistral::UtoX</code> and <code>mistral::XtoU</code> let go from one representation to the other.</p>

<p>Let us detail the use of <code>UtoX</code> (and similarly of <code>XtoU</code>). The supported distributions are:</p>

<ul>
<li>Normal: defined by its mean and standard deviation</li>
<li>Lognormal: defined by its internal parameters <code>P1=meanlog</code> and <code>P2=sdlog</code> (see <code>*lnorm</code> help page)</li>
<li>Uniform: defined by its internal parameters <code>P1=min</code> and <code>P2=max</code> (see <code>*unif</code> help page)</li>
<li>Gumbel: defined by its internal parameters <code>P1</code> and <code>P2</code></li>
<li>Weibull: defined by its internal parameters <code>P1=shape</code> and <code>P2=scale</code> (see <code>*weibull</code> help page)</li>
<li>Gamma: defined by its internal parameters <code>P1=shape</code> and <code>P2=scale</code> (see <code>*gamma</code> help page)</li>
<li>Beta: defined by its internal parameters <code>P1=shape1</code> and <code>P2=shape2</code> (see <code>*beta</code> help page)</li>
</ul>

<p>Let us define for instance a random vector \(\mathbf{X}\) in 2d such that its coordinates are standard Gaussian:</p>

<pre><code class="r">distX1 &lt;- list(type=&#39;Norm&#39;,  MEAN=0.0, STD=1.0, P1=NULL, P2=NULL, NAME=&#39;X1&#39;)
distX2 &lt;- list(type=&#39;Norm&#39;,  MEAN=0.0, STD=1.0, P1=NULL, P2=NULL, NAME=&#39;X2&#39;)
input.margin &lt;- list(distX1,distX2)
</code></pre>

<p>and correlated \(cor(X_1, X_2) = 0.5\):</p>

<pre><code class="r">input.Rho    &lt;- matrix( c(1.0, 0.5,
                          0.5, 1.0),nrow=2)
input.R0     &lt;- mistral::ModifCorrMatrix(input.Rho)
L0           &lt;- t(chol(input.R0))
</code></pre>

<p>then the function <code>UtoX</code> writes:</p>

<pre><code class="r">U &lt;- rnorm(2)
U &lt;- cbind(U, U)
X &lt;- mistral::UtoX(U, input.margin, L0)
X
</code></pre>

<pre><code>##            [,1]       [,2]
## [1,] -0.1721085 -0.1721085
## [2,]  2.6023228  2.6023228
</code></pre>

<p>The function <code>UtoX</code> works with vectors or matrices and always returns a matrix. Eventually the limit-state function can be defined by:</p>

<pre><code class="r">lsf_U = function(U) {   
    X &lt;- mistral::UtoX(U, input.margin, L0)
    lsf(X)
}
</code></pre>

<h3>Defining a proper limit-state function <code>lsf</code></h3>

<p>All the methods implemented in <code>mistral</code> and presented in this vignette require that <code>lsf</code> be a function taking a matrix as input and returning a vector as ouput. Indeed, in order to allow for parallel computing, batches of points to be evaluated are given as a matrix of column vectors. Hence, depending on the processing capaiblities and/or the implementation, computation of the model \(g\) on the points \(\mathbf{X}\) can be made a lot faster.</p>

<p>Let us define an easy 2-dimensional function:</p>

<pre><code class="r">lsf &lt;- function(x){
  x[1] + x[2]
}
</code></pre>

<p>This function can be called onto a vector:</p>

<pre><code class="r">x &lt;- c(1,2)
lsf(x)
</code></pre>

<pre><code>## [1] 3
</code></pre>

<p>or a matrix:</p>

<pre><code class="r">x &lt;- as.matrix(x)
lsf(x)
</code></pre>

<pre><code>## [1] 3
</code></pre>

<p>However, one wants it to be able to address matrices with several columns representing different points:</p>

<pre><code class="r">x &lt;- cbind(x,x)
lsf(x)
</code></pre>

<pre><code>## [1] 3
</code></pre>

<p>This obviously does not provide the expected result. There are indeed several possibilities to make the example fit into our framework. In this simple case, one has an analytical expression of the function. This can arise when using the package for educational/illustrative purpose. An easy way to fix that is then to redefine the function with <code>x</code> as a matrix:</p>

<pre><code class="r">lsf &lt;- function(x) {
  x[1,] + x[2,]
}
lsf(x)
</code></pre>

<pre><code>## [1] 3 3
</code></pre>

<p>Note here that the function considers each <strong>column</strong> as a single point. This is to be consistent with the default behaviour of <code>as.matrix</code> function:</p>

<pre><code class="r">x &lt;- 1:2
as.matrix(x)
</code></pre>

<pre><code>##      [,1]
## [1,]    1
## [2,]    2
</code></pre>

<p>Now looking back at our function, one has:</p>

<pre><code class="r">x &lt;- cbind(x,x)
lsf(x[,1])
</code></pre>

<pre><code>## Error in x[1, ]: nombre de dimensions incorrect
</code></pre>

<p>The function returns an error because default R behaviour is to drop the dimensions when selecting only one column. All together, a robust way to define a function is to apply first <code>as.matrix</code>:</p>

<pre><code class="r">lsf &lt;- function(x) {
  x &lt;- as.matrix(x)
  x[1,] + x[2,]
}
lsf(x[,1])
</code></pre>

<pre><code>## [1] 3
</code></pre>

<p>In general (practical) settings, no analytical expression is available. Let us denote by <code>myCode</code> the given computer code. <code>myCode</code> is supposed to be able to be called onto a vector. Then the <code>apply</code> function can be used:</p>

<pre><code class="r">lsf &lt;- function(x){
  x &lt;- as.matrix(x)
  apply(x, 2, myCode)
}
</code></pre>

<p>When parallel computing is availble, it is then possible to make a parallel calculation of a batch of points given as a matrix. Let us give an example using the <a href="https://cran.r-project.org/package=foreach"><code>foreach</code></a> and <a href="https://cran.r-project.org/package=iterators"><code>iterators</code></a> packages (we recommand the user to read their very nice <a href="https://cran.r-project.org/package=foreach">vignettes</a> to get started with the <code>foreach</code> loop, which is useful not only for parallel computing but also as a nice alternative to the <code>*apply</code> family).</p>

<pre><code class="r">require(foreach)
</code></pre>

<pre><code>## Loading required package: foreach
</code></pre>

<pre><code>## Warning: package &#39;foreach&#39; was built under R version 4.0.3
</code></pre>

<pre><code class="r">lsf &lt;- function(x){
  x &lt;- as.matrix(x)
  foreach(x = iterators::iter(x, by = &#39;col&#39;), .combine = &#39;c&#39;) %dopar% {
    myCode(x)
  }
}
</code></pre>

<h2>Giving known points in input</h2>

<p>Some methods implemented in <code>mistral</code> allow for giving in inputs already evaluated samples (from previous calculation for instance). The formalism is always the following:</p>

<ul>
<li>the input samples are given with the variable <code>X</code></li>
<li>the value of the <code>lsf</code> on these samples is given in <code>y</code></li>
</ul>

<p><code>X</code> should be a matrix with <code>nrow = dimension</code> and <code>ncol = number of samples</code> so that <code>length(y) = ncol(X)</code>. Note that if <code>y</code> is missing, it will be calculated by the algorithm.</p>

<h2>Short tutorial for using parallel computation with <code>foreach</code></h2>

<p>In the previous section we have shown how to use the <code>foreach</code> loop to define a well-suited function for using parallel computation. Indeed, <code>foreach</code> requires the initilisation of a parallel backend to run <em>effectively</em> in parallel. For instance, using the above code without further initilisation will issue a <code>Warning</code>:</p>

<pre><code class="r">myCode &lt;- function(x) x[1] + x[2]
x &lt;- 1:2
lsf(x)
</code></pre>

<pre><code>## Warning: executing %dopar% sequentially: no parallel backend registered
</code></pre>

<pre><code>## [1] 3
</code></pre>

<p>Basically, a parallel backend can be understood as a way of defining what <em>parallel</em> means for the (master) R session. The simplest, and not of great interest, backend is the <em>sequential</em> one:</p>

<pre><code class="r">foreach::registerDoSEQ()
</code></pre>

<p>This tells R that <em>parallel</em> means indeed usual sequential computation. However the interest of parallel computation is to run <em>simultaneously</em> several tasks.</p>

<p>With R, the management of these <em>parallel</em> tasks is let to the task manager of the used computer. In other words, <strong>initialising a parallel backend with R is only a easy way to launch several R sessions and to make them communicate</strong>. This means that there is no theoretical requirement for initialising a backend with a number of parallel <em>workers</em> equal to the number of physical cores of the machine. Eventually if more parallel tasks than real cores are initialised, the management of the tasks is let to the native task manager while if less workers are initialised, the <code>foreach</code> loop distributes the computational load.</p>

<p>There are two main possible frameworks for parallel computing: OpenMP and MPI. Without digging to much into the details, OpenMP lets you use the several cores of one given <em>computer</em> (one shared memory) while MPI allows for using several computers connected with a bus.</p>

<p>Let us first focus on OpenMP. Depending on the OS of the workstation (Windows or Mac/Linux), you can use either <a href="https://cran.r-project.org/package=doSNOW"><code>doSNOW</code></a>  or <a href="https://cran.r-project.org/package=doMC"><code>doMC</code></a>. SNOW (Simple Network of Workstations) is available for both Windows and Unix OS. It requires to first create a cluster with base package <code>parallel::makeCluster()</code>. This means that the subsequent R sessions (slave sessions in parallel terminology) are created once for all in the beginning. It is like opening several R sessions by hand: looking at your task manager you will see as many R processes as the size of the requested cluster.</p>

<pre><code class="r"># return the number of cores of the computer
n &lt;- parallel::detectCores()
# default behaviour if n not specified explained in the help page
cl &lt;- parallel::makeCluster(1)
doSNOW::registerDoSNOW(cl)

# Control that everything is set properly
foreach::getDoParName()
foreach::getDoParWorkers()
</code></pre>

<p>In the end, the cluster has to be closed with:</p>

<pre><code class="r">parallel::stopCluster(cl)
</code></pre>

<p>The other option for Unix OS is <code>doMC</code>. The main difference is that the cluster is made by <em>forking</em> the current master session, ie. that the sub-sessions are a copy of the current session, including all the variables defined in the <code>.GlobalEnv</code>. It is easier to initialise and more robust (SNOW can miss variable even though <code>foreach</code> tries an automatic export of the necessary ones):</p>

<pre><code class="r"># default behaviour if n not specified explained in the help page
doMC::registerDoMC()
</code></pre>

<p>Here there is no need to close the cluster because it is created on-the-fly for each instance of the <code>foreach</code> loop.</p>

<p>The initialisation of an MPI backend is rather similar to the one of a SNOW backend:</p>

<pre><code class="r"># instead of parallel::detectCores() to see the available number of MPI threads
Rmpi::mpi.universe.size() 
cl &lt;- doMPI::startMPIcluster()
doMPI::registerDoMPI(cl)
</code></pre>

<p>and similarly in the end:</p>

<pre><code class="r">doMPI::closeCluster(cl)
Rmpi::mpi.quit()
</code></pre>

<p>The interested reader is referred to the vignettes of the above mentionned packages for further explanations.</p>

<h2>Statistical methods for uncertainty quantification</h2>

<p>In this section, we describe the <em>purely</em> statistical methods proposed in <code>mistral</code> for uncertainty quantification. Indeed the uncertainty quantification problem is twofold:</p>

<ul>
<li>is there an analytical formula for the sought probability?</li>
<li>is it possible to use the <em>real</em> model <code>myCode</code> or is it necessary to build a <em>surrogate</em> model?</li>
</ul>

<p>The statistical methods aim at solving the first issue, ie. at estiamting the probability when no analytical expression is found.</p>

<h3>Crude Monte Carlo method</h3>

<p>The crude Monte Caro method is based on the Strong Law of Large Numbers. Basically it makes an average of independent and identically distributed (iid) samples. A basic way to implement it could be:</p>

<pre><code class="r">X &lt;- matrix(rnorm(2e5), nrow = 2) # generate 1e5 standard Gaussian samples
Y &lt;- mistral::kiureghian(X) # evaluate to model to get 1e5 iid samples
q &lt;- 0 # define the threshold
(p &lt;- mean(Y&lt;q)) # estimate P[g(X)&lt;0]
</code></pre>

<pre><code>## [1] 0.00289
</code></pre>

<p>The function <code>mistral::MonteCarlo</code> is a wrap-up of this simple algorithm. However, instead of specifying a given number of samples, it works iteratively by adding <code>N_batch</code> samples per iteration until a target precision <code>precision</code> on the probability estimation is reached (usually a coefficient of variation of 5 or 10\%) or <code>N_max</code> samples have been simulated.</p>

<pre><code class="r">mc &lt;- mistral::MonteCarlo(dimension = 2, lsf = mistral::kiureghian, N_max = 1e5, q = q,
                          # these first parameters are exactly the one used above
                           N_batch = 1e4) # define the batch size
</code></pre>

<pre><code>## ========================================================================
##                  Beginning of Monte-Carlo algorithm
## ========================================================================
## 
## ========================================================================
##                     End of Monte-Carlo algorithm
## ========================================================================
## 
##    - p = 0.00316 
##    - q = 0 
##    - 95% confidence intervalle : 0.002805034 &lt; p &lt; 0.003514966 
##    - cov = 0.05616544 
##    - Ncall = 1e+05
</code></pre>

<p>In this latter example, the target precision is not reached but the algorithm stopped because of the limit given by <code>N_max</code>. It is possible to set <code>N_max = Inf</code>:</p>

<pre><code class="r">mc &lt;- mistral::MonteCarlo(dimension = 2, lsf = mistral::kiureghian, N_max = Inf, q = q,
                           N_batch = 1e4, # define the batch size
                           verbose = 1) # control the level of log messages
</code></pre>

<pre><code>## ========================================================================
##                  Beginning of Monte-Carlo algorithm
## ========================================================================
## 
##  * STEP 1 : FIRST SAMPLING AND ESTIMATION 
##  * STEP 2 : LOOP UNTIL COV &lt; PRECISION 
##  * cov = 0.1921901 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.1371784 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.1138142 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.09840598 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.09005599 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.07920001 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.07206974 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.06555795 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.06145541 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.05833497 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.05573306 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.05322195 &gt; 0.05 and Inf remaining calls to the LSF 
##  * cov = 0.05108922 &gt; 0.05 and Inf remaining calls to the LSF 
## ========================================================================
##                     End of Monte-Carlo algorithm
## ========================================================================
## 
##    - p = 0.002942857 
##    - q = 0 
##    - 95% confidence intervalle : 0.002653316 &lt; p &lt; 0.003232398 
##    - cov = 0.04919392 
##    - Ncall = 140000
</code></pre>

<p>and total number of calls (simulated samples) is \(1.4 &times; 10<sup>5</sup>\).</p>

<p>As for the base <em>cdf</em> functions <code>p****</code> (<code>pnorm, plnorm, punif...</code>) the statistical methods of <code>mistral</code> integrate a <code>lower.tail</code> parameter specifying which tail is to be estimated:</p>

<ul>
<li><code>lower.tail = TRUE</code> means that one estimates \(P[g(X) < q]\)</li>
<li><code>lower.tail = FALSE</code> means instead \(P[g(X) > q]\)</li>
</ul>

<p>For illustrative purpose it is also possible to plot the contour of the limit-state function. All <code>mistral</code> functions let draw samples and contour with <code>ggplot2</code> functions even though this can be quite memory and time demanding:</p>

<pre><code class="r">mc &lt;- mistral::MonteCarlo(dimension = 2, lsf = mistral::kiureghian, N_max = 1e4, q = q,
                           N_batch = 1e4, # define the batch size
                           plot = TRUE)
</code></pre>

<pre><code>## ========================================================================
##                  Beginning of Monte-Carlo algorithm
## ========================================================================
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk mistral-MC-plot"/></p>

<pre><code>## ========================================================================
##                     End of Monte-Carlo algorithm
## ========================================================================
## 
##    - p = 0.0034 
##    - q = 0 
##    - 95% confidence intervalle : 0.002235794 &lt; p &lt; 0.004564206 
##    - cov = 0.1712068 
##    - Ncall = 10000
</code></pre>

<p>The <code>MonteCarlo</code> method also returns the empirical cdf of the real-valued random variable \(Y = g(\mathbf{X})\) (similarly to the base <code>stats::ecdf</code> function):</p>

<pre><code class="r">require(ggplot2)
</code></pre>

<pre><code>## Loading required package: ggplot2
</code></pre>

<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.3
</code></pre>

<pre><code class="r">y = seq(-5, 10, l = 200)
ggplot(data.frame(y=y, ecdf = mc$ecdf(y)), aes(y,ecdf)) + geom_line()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk MC-ecdf-plot"/></p>

<h3>Subset Simulation method</h3>

<p>As visible in the Monte Carlo method plot, this method is quite inefficient because it samples a lot in the safety domain (the red dots). To circumvent this limitation, the splitting method, also called <em>Subset Simulation</em> and implemented as <code>mistral::SubsetSimulation</code> works iteratively on the threshold \(q\). Instead of trying to estimate directly \(P[g(X) < q]\) it creates a sequence of intermediate thresholds \((q_i)\) such that the <strong>conditional probabilities are not too small</strong>. Hence, instead of simulating new iid <code>N_batch</code> it resamples the <code>N_batch</code> using Markov Chain drawing conditionally to be greater than a threshold defined as the <code>p_0</code> empirical quantile of the previous batch.</p>

<pre><code class="r">ss &lt;- mistral::SubsetSimulation(dimension = 2, lsf = mistral::kiureghian, q = 0,
                                N = 1e4,
                                plot = TRUE)
</code></pre>

<pre><code>## ========================================================================
##                 Beginning of Subset Simulation algorithm 
## ========================================================================
##    - q_0 = 2.924784 
##    - P = 0.1
</code></pre>

<pre><code>##    - q_0 = 1.024272 
##    - P = 0.01
</code></pre>

<pre><code>##    - q_0 = 0 
##    - P = 0.003205
</code></pre>

<div class="scianimator">
<div id="SubsetSimulation" style="display: inline-block;">
</div>

<p></div></p>

<script type="text/javascript">
  (function($) {
    $(document).ready(function() {
      var imgs = Array(6);
      for (i = 0; ; i++) {
        if (i == imgs.length) break;
        imgs[i] = "figure/SubsetSimulation-" + (i + 1) + ".png";
      }
      $("#SubsetSimulation").scianimator({
          "images": imgs,
          "delay": 1000,
          "controls": ["first", "previous", "play", "next", "last", "loop", "speed"],
      });
      $("#SubsetSimulation").scianimator("play");
    });
  })(jQuery);
</script>

<pre><code>## ========================================================================
##                  End of Subset Simulation algorithm 
## ========================================================================
##    - p = 0.003205 
##    - q = 0 
##    - 95% confidence intervalle : 0.002917476 &lt; p &lt; 0.003492524 
##    - cov = 0.04485546 
##    - Ncall = 410000
</code></pre>

<p>Note here that the total number of calls <code>Ncall</code> is much bigger than <code>3 x N</code>. Indeed the conditional sampling with Markov Chain drawing requires to retain only one over <code>thinning = 20</code> samples. In the end in this example it makes a total of \(10^4 + 2 \times 20 \times 10^4 = 410000\). As a matter of fact a naive Monte Carlo estimator with the same computational budget (ie. \(410000\) samples) would have produced an estimator with a coefficient of variation:
\[
cov \approx \sqrt{\dfrac{1}{p \times 410000}} = 0.0275863
\]
As a rule of thumbs when the sought probability is greater than \(10^{-3}\) it is more efficient to use a crude Monte Carlo method than a advanced <em>Splitting</em> method<sup>[this</sup> rule depends on the <code>thinning</code> parameter.].</p>

<h3>Moving Particles</h3>

<p>In the usual Subset Simulation method the cutoff probability for defining the intermediate thresholds is set to <code>p_0 = 0.1</code>. Hence at a given iteration <code>N</code> samples are generated conditionally greater than this empirical quantile. However, it has been shown that it is statistically optimal (total number of generated samples against coefficient of variation of the final estimator) to resample these <code>N</code> <em>particles</em> according to <strong>their own level</strong>. It means that instead of using the $N-$sample \((Y_i)_{i=1}^N = (g(\mathbf{X}_i))_{i=1}^N\) to estimate a <code>p_0</code> quantile for \(Y\), each \(\mathbf{X}_i\) is resampled conditionally to be greater than \(Y_i\).</p>

<p>More precisely, the Moving Particle method aims at simulating independent and identically distributed (iid) realisations of a given random walk over the real-valued output \(Y = g(\mathbf{X})\). This random walk is defined as follows: \(Y_0 = -\infty\) and
\[
Y_{n+1} \sim Y | Y > Y_n
\]
In other words, each element is generated conditionally greater than the previous one. This random walk is a Poisson process and lets build true counterparts of the crude Monte Carlo estimators of a probability, of a quantile or of the <em>cdf</em> of \(Y\). </p>

<p>Since the algorithm generates iid realisations of such a random walk, it is especially suited for using with parallel computing. Hence the code includes a <code>foreach</code> loop and will directely benefit from a parallel backend.</p>

<pre><code class="r">foreach::registerDoSEQ()
mp &lt;- mistral::MP(dimension = 2,  lsf = mistral::kiureghian, q = 0, N = 1e2)
</code></pre>

<pre><code>## ========================================================================
##                        Beginning of MP algorithm
## ========================================================================
##  ### PARALLEL PART ###
##  * backend: doSEQ 
##  * N.batch = 1 
## 
## ========================================================================
##                         End of MP algorithm 
## ========================================================================
## 
##    - p = 0.002197017 
##    - q = 0 
##    - 95% confidence intervalle : 0.001352829 &lt; p &lt; 0.003567995 
##    - Total number of calls = 12280
</code></pre>

<p>One can compare this result with the one got from <code>SubsetSimulation</code> in terms of coefficient of variation against total number of calls.</p>

<pre><code class="r">ss$cv^2*ss$Ncall / (mp$cv^2*sum(mp$Ncall))
</code></pre>

<pre><code>## [1] 1.101251
</code></pre>

<p>The <code>MP</code> method not only returns an estimation of the sought probability \(p\) but also an empirical <em>cdf</em> of \(Y = g(\mathbf{X})\) over the interval \([q, \infty)\) (with <code>lower.tail = TRUE</code>, the complementary <em>cdf</em> over \((-\infty, q]\) otherwise).</p>

<pre><code class="r">y = seq(0, 10, l = 200)
ggplot(data.frame(y=y, ecdf = mp$ecdf(y)), aes(y,ecdf)) + geom_line()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk MP-ecdf"/></p>

<p>The empirical <em>cdf</em> is vectorized over <code>q</code> and returns a <code>NA</code> when the value is not in the right interval.
It can also be used to estimate a quantile:</p>

<pre><code class="r">mp &lt;- mistral::MP(dimension = 2,  lsf = mistral::kiureghian, p = mp$p, N = 1e2)
</code></pre>

<pre><code>## ========================================================================
##                        Beginning of MP algorithm
## ========================================================================
##  =============================================== 
##  STEP 1 : MOVE PARTICLES A GIVEN NUMBER OF TIMES 
##  =============================================== 
## 
##  * Number of deterministic event per algorithm = 613 
## 
##  ### PARALLEL PART ###
##  * backend: doSEQ 
##  * N.batch = 1 
## 
##  ===================================================== 
##  STEP 2 : RESTART ALGORITHM UNTIL -0.5313785  
##  ===================================================== 
## 
##  ### PARALLEL PART ###
##  * backend: doSEQ 
##  * N.batch = 1 
## 
## ========================================================================
##                         End of MP algorithm 
## ========================================================================
## 
##    - p = 0.002197017 
##    - q = -0.5029999 
##    - 95% confidence intervalle : NA &lt; q &lt; -0.08655454 
##    - Maximum number of moves/algorithm = 613 
##    - L_max = -0.5313785 
##    - Number of moves = 615 
##    - Targeted number of moves = 613 
##    - Total number of calls = 12380
</code></pre>

<p>This latter estimation also enables parallel computation but in a 2-step algorithm. The empirical <em>cdf</em> is estimated until the farthest <em>state</em> reached by the iid random walks. Note also that the condifence interval requires to run the algorithm a little bit longer and thus is optional: default parameter <code>compute_confidence = FALSE</code>.</p>

<pre><code class="r">mp &lt;- mistral::MP(dimension = 2,  lsf = mistral::kiureghian, p = mp$p, N = 1e2,
                  compute_confidence = TRUE)
</code></pre>

<pre><code>## ========================================================================
##                        Beginning of MP algorithm
## ========================================================================
##  =============================================== 
##  STEP 1 : MOVE PARTICLES A GIVEN NUMBER OF TIMES 
##  =============================================== 
## 
##  * Number of deterministic event per algorithm = 661 
## 
##  ### PARALLEL PART ###
##  * backend: doSEQ 
##  * N.batch = 1 
## 
##  ===================================================== 
##  STEP 2 : RESTART ALGORITHM UNTIL -0.8924582  
##  ===================================================== 
## 
##  ### PARALLEL PART ###
##  * backend: doSEQ 
##  * N.batch = 1 
## 
## ========================================================================
##                         End of MP algorithm 
## ========================================================================
## 
##    - p = 0.002197017 
##    - q = -0.4324961 
##    - 95% confidence intervalle : -0.8822425 &lt; q &lt; -0.03246047 
##    - Maximum number of moves/algorithm = 661 
##    - L_max = -0.8924582 
##    - Number of moves = 663 
##    - Targeted number of moves = 662 
##    - Total number of calls = 13340
</code></pre>

<p>Finally, the conditional sampling for the <code>MP</code> method also requires Markov Chain drawing and the same disclaimer as for the <code>SubsetSimulation</code> applies: this method is really worth for \(p \leq 10^{-3}\).</p>

<h2>Metamodel based algorithms</h2>

<p>In the previous section, we have shown some statistical tools to estimate probability, quantile and <em>cdf</em> with a given function \(g\). However, these statistics still require a lot a calls to the model \(g\). Thus it may be necessary to approximate it, ie. to <em>learn</em> it with some of its input-output couples \((\mathbf{X}_i, Y_i)_i\).</p>

<p>In <code>mistral</code> there are basically three types of metamodel implemented:</p>

<ul>
<li>linear model: the <code>FORM</code> method <em>replaces</em> the model \(g\) with a hyperplane crossing the so-called <em>Most Probable Failure Point</em>. This point is, in the standard space, the failing sample the closest to the origin.</li>
<li>Support-Vector Machine (SVM): this classifier is used in the <code>S2MART</code> method and relies on the <a href="https://cran.r-project.org/package=e1071"><code>e1071::svm</code></a> function.</li>
<li>Gaussian process regession; this is used in <code>MetaIS</code>, <code>AKMCS</code> and <code>BMP</code>. Here the model \(g\) is <em>replaced</em> by a Gaussian random process with known distribution. The regression is carried out using the <a href="https://cran.r-project.org/package=DiceKriging"><code>DiceKriging</code></a> package.</li>
</ul>

<h3>Short tutorial on the metamodels used</h3>

<h4>Support-Vector Machine</h4>

<p>A Support-Vector Machine is a surrogate model which aims at <strong>classifying</strong> the samples of the input space according to some labels attached on it. In our context the label is straightforward: failing or safety domain. From a bunch of input-outputs couples, it builds a frontier and lets classify any new sample \(\mathbf{X}\).</p>

<p>When talking about SVM, one often makes mention of the <em>kernel trick</em>. Indeed the SVM was initially build as a linear classifier, ie that it looked for an hyperplane separating the input space into two subspaces, each one being related to a given label. However this was far too constraining. The use of a kernel instead of the natural inner product lets build more complex non-linear classifiers.</p>

<pre><code class="r">require(e1071)
</code></pre>

<pre><code>## Loading required package: e1071
</code></pre>

<pre><code>## Warning: package &#39;e1071&#39; was built under R version 4.0.4
</code></pre>

<pre><code class="r">X &lt;- data.frame(x1 = rnorm(100), x2 = rnorm(100))
Y &lt;- rowSums(X^2)
(svm.model &lt;- svm(X, (Y&gt;1), type = &quot;C-classification&quot;))
</code></pre>

<pre><code>## 
## Call:
## svm.default(x = X, y = (Y &gt; 1), type = &quot;C-classification&quot;)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
## 
## Number of Support Vectors:  37
</code></pre>

<pre><code class="r">X.test &lt;- data.frame(x1=rnorm(1), x2=rnorm(1))
predict(svm.model, X.test)
</code></pre>

<pre><code>##    1 
## TRUE 
## Levels: FALSE TRUE
</code></pre>

<pre><code class="r">sum(X.test^2)
</code></pre>

<pre><code>## [1] 1.588702
</code></pre>

<p>The interested reader is referred to the <a href="https://cran.r-project.org/package=e1071"><code>e1071::svm</code> vignette</a> for more details about SVM.</p>

<h4>Kriging</h4>

<p>Kriging refers to the case where the computer code \(g\) is seen as a specific realisation of a random process with known distribution.</p>

<p>In computer experiement, this random process is always supposed to be Gaussian. Furthermore, the parameters of the random process covariance are usually estimated with a plug-in approach: in a first step the model is fitted with some data (with Maximum Likelihood Estimation of Cross-Validation for instance). Then they are supposed to be known and thus the distribution of the process at any point \(\mathbf{x}\) is Gaussian with known mean and variance.</p>

<p>These quantities are referred to as the kriging mean and the kriging variance. While the first one usually serves as a cheap surrogate model for \(g\), the second one lets characterise the <em>precision</em> of the prediction. Especially Kriging interpolates the data: the kriging variance at known location is 0.</p>

<pre><code class="r">require(DiceKriging)
</code></pre>

<pre><code>## Loading required package: DiceKriging
</code></pre>

<pre><code>## Warning: package &#39;DiceKriging&#39; was built under R version 4.0.4
</code></pre>

<pre><code class="r">X &lt;- data.frame(x1 = rnorm(100), x2 = rnorm(100))
Y &lt;- rowSums(X^2)
km.model &lt;- km(design = X, response = Y)
</code></pre>

<pre><code>## 
## optimisation start
## ------------------
## * estimation method   : MLE 
## * optimisation method : BFGS 
## * analytical gradient : used
## * trend model : ~1
## * covariance model : 
##   - type :  matern5_2 
##   - nugget : NO
##   - parameters lower bounds :  1e-10 1e-10 
##   - parameters upper bounds :  8.875278 10.88159 
##   - best initial criterion value(s) :  431.8963 
## 
## N = 2, M = 5 machine precision = 2.22045e-16
## At X0, 0 variables are exactly at the bounds
## At iterate     0  f=       -431.9  |proj g|=        2.826
## At iterate     1  f =      -447.81  |proj g|=             0
## 
## iterations 1
## function evaluations 2
## segments explored during Cauchy searches 2
## BFGS updates skipped 0
## active bounds at final generalized Cauchy point 2
## norm of the final projected gradient 0
## final function value -447.805
## 
## F = -447.805
## final  value -447.805237 
## converged
</code></pre>

<pre><code class="r">x.new &lt;- data.frame(x1=rnorm(1), x2=rnorm(1))
print(sum(x.new^2))
</code></pre>

<pre><code>## [1] 0.5738125
</code></pre>

<pre><code class="r">predict(km.model, x.new, type = &quot;UK&quot;)[c(&#39;mean&#39;, &#39;sd&#39;)]
</code></pre>

<pre><code>## $mean
## [1] 0.5738155
## 
## $sd
## [1] 6.758386e-05
</code></pre>

<h3>The <code>FORM</code> method</h3>

<p>The <code>mistral::FORM</code> function always tries to estimate \(P[g(\mathbf{X}) < 0]\) with \(\mathbf{X}\) in the standard space. As for statistical methods, <code>mistral::UtoX</code> can be used to transform the original limit-state function onto a suitable one.</p>

<p>Furthermore the limit-state function may have to be modified to fit the used framework: say for instance that one wants to estimate \(P[g(\mathbf{X}) > q]\), then one should define:</p>

<pre><code class="r">lsf.FORM = function(x) {
   q - g(x)
}
</code></pre>

<p>The <code>FORM</code> function requires two parameters: a starting point for the research of the Most Probable Failing Point <code>u.dep</code> and a total number of calls <code>N.calls</code>:</p>

<pre><code class="r">form &lt;- mistral::FORM(dimension = 2, mistral::kiureghian, N.calls = 1000, u.dep = c(0,0))
form$p
</code></pre>

<pre><code>## [1] 0.001832186
</code></pre>

<p>The FORM method gives an analytical expression of the sought probability replacing the true model \(g\) with the found hyperplane. However, <code>mistral::FORM</code> also implements an Importance Sampling scheme. Instead of using this ready-made formula, it makes an IS estimation with a Gaussian standard proposal distribution centred at the MPFP.</p>

<pre><code class="r">form.IS &lt;- mistral::FORM(dimension = 2, mistral::kiureghian, N.calls = 1000,
                         u.dep = c(0,0),
                         IS = TRUE)
</code></pre>

<pre><code>## Warning in u.dep %*% u.dep/2 - as.numeric(v.temp %*% u.dep): Recycling array of length 1 in array-vector arithmetic is deprecated.
##   Use c() or as.vector() instead.
</code></pre>

<pre><code class="r">form.IS$p
</code></pre>

<pre><code>## [1] 0.001901383
</code></pre>

<p>In this latter case, the variance and the confidence interval at 95\% are given in output. Note however that the estimated variance may be far from the real one.</p>

<h3>The <code>MetaIS</code> method</h3>

<p><code>MetaIS</code>, for Metamodel-based Importance Sampling, is another metamodelling technique using a surrogate model in addition to an importance sampling scheme. Here, instead of using the input distribution only re-centred at the MPFP, the optimal (zero-variance) importance distribution is approximated with a Kriging-based surrogate model.</p>

<p>More precisely, recall that the optimal distibution is given by:
\[
\pi(\mathbf{x}) = \dfrac{1_{g(\mathbf{x}) > q}}{P[g(\mathbf{X}) > q]}
\]
the <em>hard</em> indicator function \(1_{g(\mathbf{x}) > q}\) is <em>replaced</em> by its kriging counterpart:
\[
\tilde{\pi}(\mathbf{x}) = P[\xi(\mathbf{x}) > q]
\]
where \(\xi\) is the Gaussian process modelling the uncertainty on the computer code \(g\). With the Gaussian hypothesis, its distribution is known.</p>

<p>The algorithm is then twofold: first the Gaussian process is <em>learnt</em>, with means that input-output samples are calculated to get a conditional distribution of the process. Then a usual Importance Sampling scheme is run. The points added iteratively to the Design of Experiments (DoE) are chosen by clustering samples generated into the <em>margin</em>. When several calls to \(g\) can be made in parallel, several points can then be added to the DoE simultaneously by chosing the number of cluster <code>K_alphaLOO</code> accordingly.</p>

<p>The enrichment step stops either when the stopping criterion is reached or when the total given nummber of samples is simulated. Then few other calls to \(g\) have to made for the Importance Sampling estimator.</p>

<pre><code class="r">metais &lt;- mistral::MetaIS(dimension = 2, lsf = mistral::waarts, N = 3e5, K_alphaLOO = 5,
                          plot = TRUE)
</code></pre>

<pre><code>## ========================================================================
##                     Beginning of Meta-IS algorithm 
## ========================================================================
## 
## ========================================================================
##  STEP 1 : Adaptative construction of h the approximated optimal density 
## ========================================================================
</code></pre>

<pre><code>## 
##  A- REFINEMENT OF PROBABILISTIC CLASSIFICATION FUNCTION PI 
##     ====================================================== 
## 
## FIRST DoE
##  -------------
</code></pre>

<pre><code>## ITERATION  1 
##  -------------
</code></pre>

<pre><code>## ITERATION  2 
##  -------------
</code></pre>

<pre><code>## ITERATION  3 
##  -------------
</code></pre>

<pre><code>## ITERATION  4 
##  -------------
</code></pre>

<pre><code>## ITERATION  5 
##  -------------
</code></pre>

<pre><code>## ITERATION  6 
##  -------------
</code></pre>

<pre><code>## 
##  B- ESTIMATE AUGMENTED FAILURE PROBABILITY USING MC ESTIMATOR  
##     ========================================================= 
##  P_epsilon = 0.002142562 
##  cov_epsilon = 0.03757646 
## 
## ===============================================
##  STEP 2 : Adaptative importance sampling scheme 
## ===============================================
</code></pre>

<div class="scianimator">
<div id="MetaIS" style="display: inline-block;">
</div>

<p></div></p>

<script type="text/javascript">
  (function($) {
    $(document).ready(function() {
      var imgs = Array(22);
      for (i = 0; ; i++) {
        if (i == imgs.length) break;
        imgs[i] = "figure/MetaIS-" + (i + 1) + ".png";
      }
      $("#MetaIS").scianimator({
          "images": imgs,
          "delay": 1000,
          "controls": ["first", "previous", "play", "next", "last", "loop", "speed"],
      });
      $("#MetaIS").scianimator("play");
    });
  })(jQuery);
</script>

<pre><code>##  alpha = 1.018401 
##  cov_alpha = 0.05772549 
## #cov_alpha too large ; this order of magnitude for alpha brings N_alpha = 134 
##  alpha = 1.006313 
##  cov_alpha = 0.04622495 
## ========================================================================
##                     End of Meta-IS algorithm 
## ========================================================================
## 
##    - P_epsilon = 0.002142562 
##    - 95% conf. interv. on P_epsilon: 0.001981542 &lt; p &lt; 0.00239794 
##    - alpha = 1.006313 
##    - 95% conf. interv. on alpha: 0.9132797 &lt; alpha &lt; 1.099347 
##    - p = 0.002156088 
##    - 95% conf. interv. on p: 0.001899097 &lt; p &lt; 0.002413079
</code></pre>

<h3>The <code>AKMCS</code> method</h3>

<p>AKMCS, for Active learning using Kriging an Monte Carlo Simulation, is an other kriging-based approach. Instead of using the Gaussian process to define a Importance density, it uses the Kriging mean as a cheap surrogate for the computer code \(g\) in a crude Monte Carlo estimator.</p>

<p>The originality and the efficiency of the <code>AKMCS</code> method comes from the fact that it samples <strong>from the beginning</strong> the Monte Carlo population and then focus on <em>learning</em> this population instead of the whole input space. The learning step is then an iterative search of the <em>more uncertain</em> points.</p>

<p>Note however that this discretisation makes the algorithm generating quite huge matrices and can lead to memory issues for extreme probabilities \(p \leq 10^{ <- 5}\).</p>

<pre><code class="r">akmcs &lt;- mistral::AKMCS(dimension = 2, lsf = mistral::waarts, N = 3e5, plot = TRUE, Nmax = 10)
</code></pre>

<pre><code>## ========================================================================
##                    Beginning of AK-MCS algorithm
## ========================================================================
</code></pre>

<pre><code>##  ============================================= 
##  STEP 1 : GENERATION OF THE WORKING POPULATION 
##  ============================================= 
## 
##  ================== 
##  STEP 2 : FIRST DoE 
##  ==================
</code></pre>

<pre><code>## Warning: Quick-TRANSfer stage steps exceeded maximum (= 15000000)
</code></pre>

<pre><code>##   - minimum value of the criterion = 2.218352 estimated in 15.69 sec. with 1 worker(s)
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>##  ======================= 
##  STEP 3 : UPDATE THE DoE 
##  =======================
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.001431084 estimated in 9.82 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.001892605 estimated in 14.99 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.01808267 estimated in 13.78 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.0008384891 estimated in 10.49 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.002310124 estimated in 10.12 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.03314481 estimated in 10.61 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.004630663 estimated in 12.47 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.02816435 estimated in 11.94 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.02640429 estimated in 12.99 sec. with 1 worker(s)
</code></pre>

<pre><code>##    - minimum value of the criterion = 0.001812548 estimated in 10.18 sec. with 1 worker(s)
</code></pre>

<div class="scianimator">
<div id="AKMCS" style="display: inline-block;">
</div>

<p></div></p>

<script type="text/javascript">
  (function($) {
    $(document).ready(function() {
      var imgs = Array(23);
      for (i = 0; ; i++) {
        if (i == imgs.length) break;
        imgs[i] = "figure/AKMCS-" + (i + 1) + ".png";
      }
      $("#AKMCS").scianimator({
          "images": imgs,
          "delay": 1000,
          "controls": ["first", "previous", "play", "next", "last", "loop", "speed"],
      });
      $("#AKMCS").scianimator("play");
    });
  })(jQuery);
</script>

<pre><code>##  =====================================
##  STEP 4 : EVALUATE FAILURE PROBABILITY
##  =====================================
##    - p = 0.001033583 
##    - failure = 0 
##    - 95% confidence interval on Monte Carlo estimate: 0.0009162508 &lt; p &lt; 0.001150915 
##  * cov = 0.05675996 
##    =&gt; cov too large ; this order of magnitude for the probability brings N = 386604
</code></pre>

<!-- ### The `S2MART` method -->

<!-- _S$^2$MART_, for Subset by Support vector Margin Algorithm for Reliability esTimation, is combination of a statistical technique called `Subset Simulation` (see above) and a learning approache based on Support Vector Machines.s -->

<!-- The core concept is to used a _small_ population in the `Subset Simulation` algorithm in order to define the sequence of intermediate thresholds. But instead of estimating the conditional probability directly with the _iid_ population, it starts a learning algorithm based on SVM, originally called `SMART` on the current threshold. In the end, the conditional probability is estimated with the boundary predicted by the SVM instead of using the code $g$. Note that this original method, referred to as `SMART` is accessible directly by using the triple dot command: `mistral:::SMART` although it is not recommended by the author. -->

<!-- This sequential approache allows this method to be used for extreme event, unlike `AKMCS` for instance. In the end, a lot of practical parameters can be set but default values are the ones set up by the author and should be modified very carefully as their meaning and impact is rather unclear. -->

<!-- ```{r S2MART, fig.keep="all", fig.show="animate"} -->

<!-- smart <- S2MART(dimension = 2, lsf = mistral::waarts, failure = -2, -->

<!--                 k1 = 3, k2 = 5, k3 = 7, -->

<!--                         plot = TRUE) -->

<!-- ``` -->

<h3>The <code>BMP</code> method</h3>

<p>The <code>BMP</code> method is a Bayesian version of the previous <code>MP</code> algorithm. Indeed, in this algorithm, the code \(g\) is considered as a Gaussian random process \(\xi\). Given a database of input-ouput couples, it is possible to estimate probability, quantile and moment of the <em>augmented</em> real-valued random variable \(Y = \xi(\mathbf{X})\):</p>

<ul>
<li>\(\mathbf{X}\) is the random vector of intputs</li>
<li>\(\xi\) is a Gaussian random process embedding the uncertainty on the code \(g\)</li>
<li>\(Y | \mathbf{X}\) is a Gaussian random variable</li>
<li>\(P[Y > q] = \int_{\mathbb{X}} P[Y > q | \mathbf{X} = \mathbf{x}] d \mu^X (\mathbf{x})\)</li>
</ul>

<p>For instance one can use the database created by the <code>AKMCS</code> method stored in the output <code>akmcs</code>:</p>

<pre><code class="r">bmp &lt;- mistral::BMP(dimension = 2, lsf = mistral::waarts, q = 0, N = 100,
                    N.iter = 0, X = akmcs$X, y = akmcs$y)
</code></pre>

<pre><code>## ========================================================================
##                Beginning of BMP algorithm
## ========================================================================
##  * parallel backend registered: TRUE 
##  * parallel backend version: doSEQ 
##    - number of workers: 1 
##  ============================================================== 
##  BEGINNING : FIRST DoE given in inputs: 30 samples 
##  ============================================================== 
## 
##  * 30 points added to the model in 0.08 sec 
##    - covtype = matern5_2 
##    - coef.cov = 1.52096 1.841783 
##    - coef.var = 0.8580864 
##    - coef.trend = 0 
##  ================================================== 
##  ENRICHMENT STEP: 0 samples to be added to the DoE 
##  ================================================== 
## 
##  * Final Poisson process N = 100 generated in 18.64 sec with 1 workers 
## ========================================================================
##                      End of BMP algorithm 
## ========================================================================
## 
##  * Current alpha estimate = 0.001023548 
##  * Current cv estimate = 0.2623829 
##  * Current h estimate = 0.2285532 
##  * Current I estimate = 1.466641 
##    - alpha = 0.001023548 
##    - cv = 0.2623829 
##    - q = 0 
##    - 95% confidence intervalle : 0.0006056272 &lt; alpha &lt; 0.001729861 
##    - Total number of calls = 30
</code></pre>

<p>The method can also be used, as the other one, to <em>learn</em> the metamodel:</p>

<pre><code class="r">bmp &lt;- mistral::BMP(dimension = 2, lsf = mistral::waarts, q = -4, N = 100,
                    N.iter = 2, plot = TRUE)
</code></pre>

<pre><code>## ========================================================================
##                Beginning of BMP algorithm
## ========================================================================
##  * parallel backend registered: TRUE 
##  * parallel backend version: doSEQ 
##    - number of workers: 1 
##  ============================================================== 
##  BEGINNING : FIRST DoE with uniform design: 10 samples 
##  ============================================================== 
## 
##  * 10 points added to the model in 0.07 sec 
##    - covtype = matern5_2 
##    - coef.cov = 15.7305 2.185518 
##    - coef.var = 2.372485 
##    - coef.trend = 4
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>##  ================================================== 
##  ENRICHMENT STEP: 2 samples to be added to the DoE 
##  ================================================== 
## 
##  Remaining iter. : 2 
##  * Poisson process N = 100 generated in 15.34 sec with 1 workers 
##  * Current alpha estimate = 4.870486e-05 
##  * Current cv estimate = 0.3151148 
##  * Current h estimate = 0.9564678 
##  * Current I estimate = 7.766147 
##  * Evaluation of SUR criterion: integrated = TRUE, r = 1, approx = FALSE, approx.pnorm = FALSE, optim = discrete, N_ppp = 100
</code></pre>

<pre><code>## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
</code></pre>

<pre><code>## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
</code></pre>

<pre><code>##  * SUR criterion: 1088 points tested in 53.25 sec 
##  * Call the lsf on the proposed point(s)
##  * Lsf evaluated in 0 sec 
##  * 1 points added to the model in 0.14 sec 
##    - covtype = matern5_2 
##    - coef.cov = 15.7305 1.731696 
##    - coef.var = 2.684634 
##    - coef.trend = 4
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>##  Remaining iter. : 1 
##  * Poisson process N = 100 generated in 17.72 sec with 1 workers 
##  * Current alpha estimate = 6.650912e-05 
##  * Current cv estimate = 0.3101318 
##  * Current h estimate = 0.9443154 
##  * Current I estimate = 7.050608 
##  * Evaluation of SUR criterion: integrated = TRUE, r = 1, approx = FALSE, approx.pnorm = FALSE, optim = discrete, N_ppp = 100
</code></pre>

<pre><code>## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
</code></pre>

<pre><code>## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in colSums(chi_r^2) * Sigma_rr_inv: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
</code></pre>

<pre><code>##  * SUR criterion: 1057 points tested in 41.87 sec 
##  * Call the lsf on the proposed point(s)
##  * Lsf evaluated in 0 sec 
##  * 1 points added to the model in 0.1 sec 
##    - covtype = matern5_2 
##    - coef.cov = 15.7305 2.141932 
##    - coef.var = 3.291833 
##    - coef.trend = 4
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<pre><code>## Warning: stat_contour(): Zero contours were generated
</code></pre>

<pre><code>## Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé
</code></pre>

<pre><code>## Warning in max(x): aucun argument pour max ; -Inf est renvoyé
</code></pre>

<div class="scianimator">
<div id="BMP_learn" style="display: inline-block;">
</div>

<p></div></p>

<script type="text/javascript">
  (function($) {
    $(document).ready(function() {
      var imgs = Array(5);
      for (i = 0; ; i++) {
        if (i == imgs.length) break;
        imgs[i] = "figure/BMP-learn-" + (i + 1) + ".png";
      }
      $("#BMP_learn").scianimator({
          "images": imgs,
          "delay": 1000,
          "controls": ["first", "previous", "play", "next", "last", "loop", "speed"],
      });
      $("#BMP_learn").scianimator("play");
    });
  })(jQuery);
</script>

<pre><code>##  * Final Poisson process N = 100 generated in 13 sec with 1 workers 
## ========================================================================
##                      End of BMP algorithm 
## ========================================================================
## 
##  * Current alpha estimate = 1.046543e-05 
##  * Current cv estimate = 0.338636 
##  * Current h estimate = 0.9473537 
##  * Current I estimate = 7.86418 
##    - alpha = 1.046543e-05 
##    - cv = 0.338636 
##    - q = -4 
##    - 95% confidence intervalle : 5.316448e-06 &lt; alpha &lt; 2.06012e-05 
##    - Total number of calls = 12
</code></pre>

<p>In this latter case, the learning step is driven with the minimisation at each iteration of the integrated criterion \(I\). This can be chosen with the argument <code>sur</code>. This integrated criterion is especially interesting when the sought probability is extreme. In this context, <code>BMP</code> is a preferred alternative to <code>S2MART</code>.</p>

<p>Note also that the estimation of quantities \(h\) and \(I\) can also be done in <code>AKMCS</code> and <code>MetaIS</code> at each iteration with their parameter <code>sur=TRUE</code> (default is <code>sur=FALSE</code>) to monitor the learning of the Gaussian process and to compare the different learning strategies.</p>

<h3>Conclusion</h3>

<p>In this vignette we wanted to present some of the methods implemented in <code>mistral</code> for reliability analysis. Precisely we focused on methods designed to estimate a probability of the code exceeding a given threshold.</p>

<p>In this setting, all the statistical and/or metamodel-based algorithms have proven in some cases good efficiency, though some of them are quite time consumming. In this context it should be remembered that they are defined considering that the calls to the limit-state functions are the only important parts while it can appear indeed that all the <em>side computations</em> take indeed much more time. The method should then be choosen accordingly. Especially in this vignette some parameters are very low to save computational time on laptop and should be increased for real experiments (see <code>S2MART</code> for instance).</p>

<p>Amongst all the strategies proposed in this package, the <code>Moving Particles</code> and <code>Bayesian Moving Particles</code> are the only one not only focusing on the given threshold but delivering an uncertainty quantification for the random output <em>until</em> this threshold. This means that the output is not a given probability but an estimation of the <em>cdf</em> of the unknown real-valued random variable.</p>

<p>The interested reader is referred to the academic papers for a deeper understanding of the algorithms and to the package documentation for a comprehensive list of the involved parameters.</p>

<pre><code></code></pre>

</body>

</html>
